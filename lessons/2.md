# Duplica√ß√£o de c√≥digo

C√≥digo duplicado √© aquele que faz exatamente a mesma coisa em v√°rios lugares (ou praticamente a mesma coisa, com pequenas altera√ß√µes).

O maior problema de c√≥digo duplicado √© que, se tal c√≥digo est√° errado, ou mesmo se precisa ser motificado por alguma outra necessidade, temos que lembrar de todos os locais onde tal c√≥digo √© implementado para fazer a mudan√ßa.

E se esquecermos de ajustar em algum lugar‚ùì

E nasce mais um bug. üêõ

C√≥digo duplicado pode ser considerado um "cheiro ruim" no c√≥digo ü¶®, e saber identific√°-lo e melhor√°-lo √© uma habilidade que diferencia algu√©m que resolve problemas imediatos versus algu√©m que se preocupa com a evolu√ß√£o do projeto no longo prazo.

Existem diferentes formas de remover duplica√ß√£o de c√≥digo, tais como a extra√ß√£o de c√≥digo duplicado em fun√ß√µes; uso de itera√ß√£o; uso de bibliotecas externas, ou at√© mesmo o simples entendimento e uso das ferramentas sendo utilizadas.

## Conte√∫dos sugeridos

Antes de seguir adiante, tenho algumas recomenda√ß√µes de conte√∫dos sobre o assunto pra te indicar:

- [Refatora√ß√£o - Mentoria Talking About Testing](https://youtu.be/p1OB4vgNFow)
- [Como rodar o mesmo teste com dados diferentes](https://youtu.be/oYnma0rmA4E)
- [Como rodar um teste v√°rias vezes com Cypress para provar que ele √© est√°vel](https://talkingabouttesting.com/2021/02/06/como-rodar-um-teste-varias-vezes-com-cypress-para-provar-que-ele-e-estavel/)
- [Como criar comandos customizados com Cypress](https://talkingabouttesting.com/2021/02/10/como-criar-comandos-customizados-com-cypress/)
- [Como marcar v√°rios checkboxes de uma s√≥ vez com Cypress](https://talkingabouttesting.com/2021/06/14/como-marcar-varios-checkboxes-de-uma-so-vez-com-cypress/)
- [Cypress hooks docs](https://docs.cypress.io/guides/core-concepts/writing-and-organizing-tests#Hooks) (em ingl√™s)
- [`cy.check()` - Cypress docs](https://docs.cypress.io/api/commands/check) (em ingl√™s)

> ü¶â Cada um dos conte√∫dos acima ir√° te ajudar com os exerc√≠cios que vem por a√≠.

## Exerc√≠cio

Abra o arquivo [`cypress/integration/duplication/sample1.spec.js`](../cypress/integration/duplication/sample1.spec.js) e remova a duplica√ß√£o do mesmo com o uso do _hook_ `beforeEach`.

## _Extra credit 1_

Abra o arquivo [`cypress/integration/duplication/sample2.spec.js`](../cypress/integration/duplication/sample2.spec.js) e remova a duplica√ß√£o existente nas a√ß√µes dos testes (n√£o nas verifica√ß√µes) com o uso de um comando customizado.

> Sugest√£o: `cy.search()`

## _Extra credit 2_

Ainda no arquivo [`cypress/integration/duplication/sample2.spec.js`](../cypress/integration/duplication/sample2.spec.js), logo ap√≥s o `beforeEach` e antes dos testes, crie uma vari√°vel chamada `terms` a qual representar√° um array com os valores `reactjs` e `vuejs`.

Logo ap√≥s, com o uso da funcionalidade [`.forEach()` do JavaScript](https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach), itere sobre cada elemento do array executando um √∫nico bloco `it`, o qual ir√° executar um teste para cada item do array.

## _Extra credit 3_

Abra o arquivo [`cypress/integration/duplication/sample3.spec.js`](../cypress/integration/duplication/sample3.spec.js), e em vez de executar 3 vezes o mesmo comando e verifica√ß√£o, utilize a funcionalidade `.times()` do lodash (que j√° vem empacotado com o Cyperss) para remover toda e qualquer duplicac√£o.

## _Extra credit 4_

Abra o arquivo [`cypress/integration/duplication/sample4.spec.js`](../cypress/integration/duplication/sample4.spec.js) e em vez de fazer um `.check()` por checkbox, tire proveito do fato de que tal comando pode marcar mais de um checkbox com uma √∫nica chamada. Basta voc√™ encontrar o seletor correto.

üôä üòÉ

```js
'fieldset div input[type="checkbox"]'
```

___

Beleza, acabamos com as duplica√ß√µes! üéä

V√° para a [aula 3](./3.md) para conhecer a terceira m√° pr√°tica (_flaky tests_), e como lidar com ela.
